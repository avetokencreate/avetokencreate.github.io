import{D as U}from"./Dialog-0ec7f86b.js";import{_ as E,e as H,d as M,m as x,f as C,g as d,r as y,o as D,h as N,b as I,j as r,w as v,u as c,F as L,s,G as W,H as j,z,t as G}from"./index-69bf0c45.js";import{u as P}from"./manage-c4d4e776.js";import{f as b,c as R}from"./index-e3a6eef1.js";import{p as q,f as J}from"./units-1c3e5529.js";/* empty css                                                       */import"./bignumber-3e8dfdf6.js";const K={class:"mint-token"},Q={__name:"MintToken",setup(X){const{t:o}=H(),_=M(),S=x(),a=P(),k=C(()=>_.walletAddress.toLowerCase()===a.owner.toLowerCase()),g=d(""),l=d(_.walletAddress),u=d(""),A=C(()=>o("operationHash",{hash:b(g.value)})),w=d(!1),h=d(!1);function V(t){return t.replace("-","")}async function $(){if(!u.value){s(o("amountEmpty"));return}if(u.value.replace(".","").length>34){s(o("amountOver"));return}let t=u.value.split(".");if(t[1]&&t[1].length>a.decimals){s(o("amountOver"));return}if(!/^0x[0-9a-fA-F]{40}(,\d*\.?\d+)?$/.test(l.value)){s(o("addressWrong"));return}h.value=!0;try{const p=await new W(window.ethereum).getSigner(),i=new j(a.tokenAddress,a.abi,p);let f=await i.mint(l.value,q(u.value,a.decimals));g.value=f.hash,f.wait().then(async n=>{if(n.status===1){s({type:"success",message:o("upChainSuccessfully")});let F=await i.totalSupply();a.totalSupply=J(F.toString(),a.decimals),u.value=""}}),w.value=!0}catch(e){console.log(e),e.info&&e.info.error&&e.info.error.code===4001?s(o("userCancelOperate")):e.error&&e.error.message&&e.error.message=="Canceled"?s(o("userCancelOperate")):s(o("unkonwError"))}finally{h.value=!1}}async function B(){S.push("/manage/"+a.deployerId+"/"+a.tokenAddress)}const m=d(l.value?b(l.value):"");function T(){m.value=l.value}function O(){l.value=m.value,/^0x[0-9a-fA-F]{40}(,\d*\.?\d+)?$/.test(l.value)?m.value=b(l.value):s(o("addressWrong"))}return(t,e)=>{const p=y("van-field"),i=y("van-cell-group"),f=y("van-button");return D(),N(L,null,[I("div",K,[r(i,{inset:""},{default:v(()=>[r(p,{modelValue:c(a).totalSupply,"onUpdate:modelValue":e[0]||(e[0]=n=>c(a).totalSupply=n),readonly:"",label:t.$t("currentTotal"),"input-align":"right"},null,8,["modelValue","label"])]),_:1}),r(i,{inset:""},{default:v(()=>[r(p,{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=n=>u.value=n),"label-width":"7em",type:"number",label:t.$t("mintTokenAmount"),placeholder:t.$t("pleaseEnter"),formatter:V,"input-align":"right"},null,8,["modelValue","label","placeholder"])]),_:1}),r(i,{inset:""},{default:v(()=>[r(p,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=n=>m.value=n),onFocus:T,onBlur:O,"label-width":"9em",label:t.$t("receivingAddress"),placeholder:t.$t("pleaseEnter"),"input-align":"right"},null,8,["modelValue","label","placeholder"])]),_:1}),r(f,{type:"primary",round:"",block:"",class:"btn",onClick:$,loading:h.value,disabled:!c(k)},{default:v(()=>[z(G(t.$t("submitAdd")),1)]),_:1},8,["loading","disabled"])]),r(U,{show:w.value,"onUpdate:show":e[3]||(e[3]=n=>w.value=n),title:t.$t("submitAddSuccessfully"),message:c(A),showCancelButton:!1,confirmButtonText:t.$t("copyHash"),onOnConfirm:e[4]||(e[4]=n=>c(R)(g.value)),onOnCancel:B},null,8,["show","title","message","confirmButtonText"])],64)}}},se=E(Q,[["__scopeId","data-v-b25f097f"]]);export{se as default};
