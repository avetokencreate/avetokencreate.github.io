import{D as F}from"./Dialog-669e60b7.js";import{_ as U,d as M,b as x,l as D,e as C,f as d,r as h,o as H,g as N,a as I,h as r,w as v,u as c,F as L,s as n,E as W,G,y as P,t as R}from"./index-47a63b08.js";import{u as j}from"./manage-e8e6c948.js";import{f as b,c as q}from"./index-5976c4bd.js";import{p as z,f as J}from"./units-0b267a92.js";/* empty css                                                       */import"./bignumber-3e8dfdf6.js";const K={class:"mint-token"},Q={__name:"MintToken",setup(X){const{t:o}=M(),_=x(),S=D(),a=j(),k=C(()=>_.walletAddress.toLowerCase()===a.owner.toLowerCase()),g=d(""),s=d(_.walletAddress),u=d(""),A=C(()=>o("operationHash",{hash:b(g.value)})),w=d(!1),y=d(!1);function V(t){return t.replace("-","")}async function $(){if(!u.value){n(o("amountEmpty"));return}if(u.value.replace(".","").length>34){n(o("amountOver"));return}let t=u.value.split(".");if(t[1]&&t[1].length>a.decimals){n(o("amountOver"));return}if(!/^0x[0-9a-fA-F]{40}(,\d*\.?\d+)?$/.test(s.value)){n(o("addressWrong"));return}y.value=!0;try{const m=await new W(window.ethereum).getSigner(),i=new G(a.tokenAddress,a.abi,m);let f=await i.mint(s.value,z(u.value,a.decimals));g.value=f.hash,f.wait().then(async l=>{if(l.status===1){n({type:"success",message:o("upChainSuccessfully")});let E=await i.totalSupply();a.totalSupply=J(E.toString(),a.decimals),u.value=""}}),w.value=!0}catch(e){console.log(e),e.info&&e.info.error&&e.info.error.code===4001?n(o("userCancelOperate")):e.error&&e.error.message&&e.error.message=="Canceled"?n(o("userCancelOperate")):n(o("unkonwError"))}finally{y.value=!1}}async function B(){S.push("/manage/"+a.deployerId+"/"+a.tokenAddress)}const p=d(s.value?b(s.value):"");function T(){p.value=s.value}function O(){s.value=p.value,/^0x[0-9a-fA-F]{40}(,\d*\.?\d+)?$/.test(s.value)?p.value=b(s.value):n(o("addressWrong"))}return(t,e)=>{const m=h("van-field"),i=h("van-cell-group"),f=h("van-button");return H(),N(L,null,[I("div",K,[r(i,{inset:""},{default:v(()=>[r(m,{modelValue:c(a).totalSupply,"onUpdate:modelValue":e[0]||(e[0]=l=>c(a).totalSupply=l),readonly:"",label:t.$t("currentTotal"),"input-align":"right"},null,8,["modelValue","label"])]),_:1}),r(i,{inset:""},{default:v(()=>[r(m,{modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=l=>u.value=l),"label-width":"7em",type:"number",label:t.$t("mintTokenAmount"),placeholder:t.$t("pleaseEnter"),formatter:V,"input-align":"right"},null,8,["modelValue","label","placeholder"])]),_:1}),r(i,{inset:""},{default:v(()=>[r(m,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=l=>p.value=l),onFocus:T,onBlur:O,"label-width":"9em",label:t.$t("receivingAddress"),placeholder:t.$t("pleaseEnter"),"input-align":"right"},null,8,["modelValue","label","placeholder"])]),_:1}),r(f,{type:"primary",round:"",block:"",class:"btn",onClick:$,loading:y.value,disabled:!c(k)},{default:v(()=>[P(R(t.$t("submitAdd")),1)]),_:1},8,["loading","disabled"])]),r(F,{show:w.value,"onUpdate:show":e[3]||(e[3]=l=>w.value=l),title:t.$t("submitAddSuccessfully"),message:c(A),showCancelButton:!1,confirmButtonText:t.$t("copyHash"),onOnConfirm:e[4]||(e[4]=l=>c(q)(g.value)),onOnCancel:B},null,8,["show","title","message","confirmButtonText"])],64)}}},ne=U(Q,[["__scopeId","data-v-b25f097f"]]);export{ne as default};
